<!DOCTYPE html>
<html>

<head>
	<script charset="utf-8" src="js/jquery.min.js?v=01291"></script>
	<script charset="utf-8" src="js/global.js?v=01291"></script>
	<script charset="utf-8" src="js/bootstrap.min.js?v=01291"></script>
	<script charset="utf-8" src="js/template.js?v=01291"></script>
	<script src="js/pc.js"></script>
	<link rel="stylesheet" href="css/bootstrap.css?v=01291">
	<link rel="stylesheet" href="css/style.css?v=1?v=01291">
	<link rel="stylesheet" href="css/member.css?v=01291">
	<link rel="stylesheet" href="css/order3.css?v=01291">
	<link rel="stylesheet" href="css/buy.css">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta content="yes" name="apple-mobile-web-app-capable">
	<meta content="yes" name="apple-touch-fullscreen">
	<meta content="telephone=no" name="format-detection">
	<meta content="black" name="apple-mobile-web-app-status-bar-style">
	<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1;user-scalable=no;">
	<script charset="utf-8" src="js/shopCart.js?v=01291"></script>
	<title>购物车</title>
	<style>
		#toast {
			display: none;
			position: fixed;
			top: 50%;
			left: 50%;
			margin-top: -20px;
			margin-left: -135px;
			width: 300px;
			height: 70px;
			border-radius: 10px;
			background: #353535;
			text-align: center;
			font-size: 1.4rem;
			line-height: 70px;
			color: #fff;
		}
	</style>
</head>

<body>
	<div class="fanhui_cou">
		<div class="fanhui_1"></div>
		<div class="fanhui_ding">顶部</div>
	</div>
	<!-- <header class="header header_1" style="margin-bottom: 10;">
		<div class="fix_nav" style="display: flex;">
			<svg style="margin-top:10px;position:absolute" t="1584199433446" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5706" width="20" height="20"><path d="M676.155199 367.576703c0-81.740676-66.580394-147.997706-148.71095-147.997706-82.129532 0-148.705833 66.258053-148.705833 147.997706 0 81.736583 66.575278 147.992589 148.705833 147.992589C609.573781 515.568269 676.155199 449.313286 676.155199 367.576703L676.155199 367.576703zM411.779949 367.576703c0-63.563688 51.782364-115.110691 115.6643-115.110691 63.880913 0 115.663276 51.548026 115.663276 115.110691 0 63.570851-51.783387 115.103528-115.663276 115.103528C463.561289 482.680231 411.779949 431.147554 411.779949 367.576703L411.779949 367.576703zM791.820522 367.576703c0-145.30027-118.357642-263.104303-264.376273-263.104303-146.020678 0-264.377296 117.804033-264.377296 263.104303 0 145.292084 264.377296 460.423321 264.377296 460.423321S791.820522 512.868787 791.820522 367.576703L791.820522 367.576703zM527.443225 137.353274c127.753639 0 231.334739 103.068424 231.334739 230.222405 0 127.149888-231.334739 411.098939-231.334739 411.098939S296.11565 494.718405 296.11565 367.576703C296.11565 240.421698 399.695726 137.353274 527.443225 137.353274L527.443225 137.353274zM644.311956 722.598462c-7.234775 9.878998-14.298658 19.358907-21.084201 28.352745 70.555939 8.087189 119.024837 24.831548 119.024837 44.162826 0 27.237341-96.176456 49.331545-214.810391 49.331545-118.633934 0-214.802204-22.094204-214.802204-49.331545 0-19.333324 48.460712-36.075637 119.014604-44.162826-6.78452-8.993838-13.845333-18.473747-21.076014-28.352745-77.959559 13.847379-130.98831 41.12463-130.98831 72.516594 0 45.416376 110.967324 82.21856 247.851924 82.21856 136.883577 0 247.851924-36.802184 247.851924-82.21856 0-31.392988-53.029774-58.669214-130.987287-72.516594L644.311956 722.598462z" p-id="5707"></path></svg>
			<div style="flex:1;padding-left: 25px;" class="inputDiv" contenteditable placeholder="请确认收货地址"></div>
			<a href="address.html" class="rightarrow">></a>
		</div>
	</header> -->
	<div class="container">
		<div class="row rowcar">
			<ul class="list-group">
				<li class="list-group-item text-primary">
					<div class="icheck pull-left mr5">
						<input type="checkbox" checked="checked" class="ids" prodStatus="1" itemkey="" />
						<label class="checkLabel">
							<span></span>
						</label>
					</div>
					马斯克(一次性卫生口罩)
				</li>
				<li class="list-group-item hproduct clearfix">
					<div class="p-pic"><a><img class="img-responsive" src="./images/kg1.png"></a>
					</div>
					<div class="p-info">
						<a>
							<p class="p-title" style="height: 20px;">
								马斯克(一次性卫生口罩)批发零售
							</p>
							<p class="p-title" style="height: 20px;">
								小于1w只统一发货价<span class="bigCount"></span>元/只
							</p>
							<p class="p-title" style="height: 20px;">
								大于1w只统一发货价
								<s><span class="bigCount"></span></s>
								<span style="color: red;" class="smallCount"></span>
								元/只
							</p>
						</a>
						<!-- <p class="p-attr">
							<span>颜色：红色；</span></p> -->
						<p class="p-origin">
							<!-- <a class="close p-close"
								onclick="deleteShopCart('','艾吉贝2015新款多层收纳真皮单肩斜挎包女包头层牛皮斜跨小包包女','663','1358')"
								href="javascript:void(0);">×</a> -->
							<!-- <em class="price">¥160.00</em> -->
						</p>
					</div>
				</li>
				<li class="list-group-item clearfix">
					<div class="pull-left mt5">
						<span class="gary">小计：</span>
						<span class="red">¥</span>
						<span class="red productTotalPrice sumPrice"></span>
					</div>
					<div class="btn-group btn-group-sm control-num">
						<a onclick="disDe(this)" href="javascript:void(0);" class="btn btn-default"><span
								class="glyphicon glyphicon-minus gary"></span></a>
						<input type="number" onchange="onfun(this)" style="width:10rem;user-select:text !important;-webkit-user-select:text !important" id="count_val"
							class="btn gary2 Amount" value="100" >
						<a onclick="increase(this)" href="javascript:void(0);" class="btn btn-default"><span
								class="glyphicon glyphicon-plus gary"></span></a>
					</div>
				</li>
			</ul>


			<div class="ps_style clearfix">
				<p class="ps_left">配送方式</p>
				<p class="ps_right">快递&nbsp;<span>免邮</span></p>
			</div>

			<div class="l_message clearfix">
				<p class="l_left">买家留言</p>
				<textarea class="l_right" name="" id="" cols="30" rows="10" placeholder="选填：对本次交易的说明"></textarea>
			</div>
		</div>


	</div>
	<div class="fixed-foot">
		<div class="fixed_inner">
			<div class="pay-point">
				<div class="icheck pull-left mr10">
					<input type="checkbox" checked="checked" id="buy-sele-all" value="1">
					<label for="buy-sele-all">
						<span class="mt10"></span>全选
					</label>
				</div>
				<p>合计：<em class="red f22">¥<span class="totalPrice"></span></em></p>
			</div>
			<div class="buy-btn-fix">
				<a class="btn btn-danger btn-buy">生成订单</a>
			</div>
		</div>
	</div>
	<div class="clear"></div>

	<footer class="footer">
		<div class="foot-con">
			<div class="foot-con_2">
				<a href="index.html">
					<i class="navIcon home"></i>
					<span class="text">首页</span>
				</a>
				<!-- <a href="shopcart.html" class="active">
					<i class="navIcon shop"></i>
					<span class="text">购物车</span>
				</a> -->
				<a href="userhome.html">
					<i class="navIcon member"></i>
					<span class="text">我的</span>
				</a>
			</div>
		</div>
	</footer>
	<div id="toast"></div>
	<script type="text/javascript">
			var smallPrice = 1.6, bigPrice = 1.7;
		function setTotal() {
			var sum = 0;
			var price = bigPrice;
			var num = parseInt($('.Amount').val());
			if(num<100 || num === NaN){
				$('.Amount').val(100)
			}
			num = parseInt($('.Amount').val());
			if (num > 0 && num < 10000) {
				price = bigPrice;
			} else {
				price = smallPrice;
			}
			sum += num * price/100;
			$(".totalPrice").text(sum.toFixed(2));
			$(".sumPrice").text(sum.toFixed(2));
		}

		function increase() {
			var t = $('.Amount');
			t.val(parseInt(t.val()) + 1);
			setTotal()
		}
		function disDe() {
			var t = $('.Amount');
			t.val(parseInt(t.val()) - 1);
			if (parseInt(t.val()) < 100) {
				t.val(100);
			}

			setTotal()
		}
		$("#count_val").bind("input propertychange", function (event) {
			setTotal()
		});
		$('.icheck').on('click', function () {
			if (!$('#buy-sele-all').is(':checked')) {
				$(".totalPrice").text(0);
				$(".sumPrice").text(0);
			} else {
				$(".totalPrice").text(bigPrice);
				$(".sumPrice").text(bigPrice);
			}
		})


		$.ajax({
			url: 'https://mask.zhixiutec.com/api/user',
			success: function (res) {
				if (res && res.error_code === 0) {
					var data = res.data;
					$.ajax({
						url:'https://mask.zhixiutec.com/api/price',
						success:function(result){
							if(result && result.error_code ===0){
								var resultData = result.data;
								bigPrice = resultData && resultData[0] && resultData[0].price;
								smallPrice = resultData && resultData[1] && resultData[1].price;
								$('.bigCount').text(bigPrice/100)
								$('.smallCount').text(smallPrice/100)
								$('.totalPrice').text(bigPrice)
								$('.sumPrice').text(bigPrice)
							}
						}
					})
					$('.btn-buy').on('click', function () {
						if (parseInt($(".totalPrice").text()) < 100) {
							alert('数量最少为100')
							return false;
						}
						$.ajax({
							url: 'https://mask.zhixiutec.com/api/create_order',
							type: 'post',
							data: JSON.stringify({ "count": parseInt($("#count_val").val()), content: $('.l_right').val() }),
							success: function (res) {
								if (res && res.error_code === 0) {
									window.open('my_order.html', '_self')
								} else {
									$("#toast").text(`${res.err_msg},正在跳转中...`);
									$("#toast").fadeIn().delay(1000).fadeOut();
									setTimeout(function () {
										window.open('my_order.html', '_self')
									}, 1000)
									return;
								}
							}
						})
					})
				} else {
					window.open(res.data, '_self')
				}
			}
		})


	</script>
</body>

</html>